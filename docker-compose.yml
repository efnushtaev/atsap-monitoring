version: "3.8"

services:
  portainer:
    image: portainer/portainer-ce:latest
    container_name: portainer
    restart: unless-stopped
    volumes:
      - /var/run/docker.sock:/var/run/docker.sock
      - portainer_data:/data
    ports:
      - "9000:9000"
    networks:
      - app-network

  client: # –ü–ï–†–ï–ú–ï–©–ï–ù–û –í –†–ê–ó–î–ï–õ SERVICES
    build:
      context: ./client # üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–û–ï –ò–ó–ú–ï–ù–ï–ù–ò–ï!
      dockerfile: Dockerfile # –ü—É—Ç—å –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –∫–æ—Ä–Ω—è
    networks:
      - app-network
    volumes:
      - ./client/build:/app/build # bind mount (–Ω–µ —Ç—Ä–µ–±—É–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏—è –≤ volumes)

  nginx:
    image: nginx:alpine
    ports:
      - "80:80"
    volumes:
      - ./nginx/nginx.conf:/etc/nginx/conf.d/default.conf
      - ./client/build:/usr/share/nginx/html # –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–±–æ—Ä–∫—É –∏–∑ client
    networks:
      - app-network
    depends_on:
      - client

volumes:
  portainer_data: # –¢–û–õ–¨–ö–û –û–ü–†–ï–î–ï–õ–ï–ù–ò–ï –¢–û–ú–ê (–±–µ–∑ –ª–∏—à–Ω–∏—Ö —Å–≤–æ–π—Å—Ç–≤)
    driver: local

networks:
  app-network:
    driver: bridge
